{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/refs.js","../src/spinner.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport class PixabayApiImages {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.per_page = 40;\n    this.totalPages = 0;\n  }\n\n  async getImages() {\n    const searchParams = new URLSearchParams({\n      key: '42127236-8bfdbbfbeed8a2dadaca720e8',\n      q: `${this.searchQuery}`,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: `${this.per_page}`,\n      page: `${this.page}`,\n    });\n\n    const { data } = await axios.get(`${BASE_URL}?${searchParams}`);\n    return data;\n  }\n\n  incrementPage() {\n    return (this.page += 1);\n  }\n\n  resetPage() {\n    return (this.page = 1);\n  }\n\n  setTotal(total) {\n    return (this.totalPages = total);\n  }\n\n  resetTotalPage() {\n    return (this.totalPages = 0);\n  }\n\n  hasMoreImages() {\n    return this.page === Math.ceil(this.totalPages / this.per_page);\n  }\n}\n","export function createMarkupImg(markup) {\n  return markup\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n\n  <div class=\"photo-card\">\n    <a class=\"photo-link\" href=\"${largeImageURL}\">\n      <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n    </a>\n      <div class=\"info\">\n     <p class=\"info-item\">\n        <b>Likes</b>${likes}\n      </p>\n     <p class=\"info-item\">\n        <b>Views</b>${views}\n      </p>\n      <p class=\"info-item\">\n        <b>Comments</b>${comments}\n     </p>\n      <p class=\"info-item\">\n       <b>Downloads</b>${downloads}\n     </p>\n  </div>\n</div>\n`;\n      }\n    )\n    .join('');\n}\n","export const refs = {\n  form: document.getElementById('search-form'),\n  gallery: document.querySelector('.gallery'),\n  infitity: document.querySelector('.infitity-scroll'),\n  body: document.querySelector('body'),\n};\n","import { refs } from './refs';\n\nexport function spinnerPlay() {\n  refs.body.classList.add('loading');\n}\n\nexport function spinnerStop() {\n  setTimeout(function () {\n    refs.body.classList.remove('loading');\n    refs.body.classList.add('loaded');\n  }, 1000);\n}\n","// import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { PixabayApiImages } from './js/pixabay-api';\nimport { createMarkupImg } from './js/render-function';\nimport { refs } from './refs';\nimport { spinnerPlay, spinnerStop } from './spinner';\n\nrefs.form.addEventListener('submit', onSubmitForm);\n\nspinnerPlay();\nspinnerStop();\n\nconst pixabay = new PixabayApiImages();\nconst lightboxGallery = new SimpleLightbox('.gallery a');\n\nasync function onSubmitForm(e) {\n  e.preventDefault();\n\n  observer.observe(refs.infitity);\n  clearGallery();\n  pixabay.resetPage();\n\n  pixabay.searchQuery = e.currentTarget.searchQuery.value.trim();\n\n  if (pixabay.searchQuery === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n\n    return;\n  }\n\n  try {\n    const response = await pixabay.getImages();\n\n    if (response.hits.length === 0) {\n      iziToast.warning({\n        title: 'Warning',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n\n      return;\n    }\n\n    const { hits, totalHits } = response;\n    pixabay.setTotal(totalHits);\n\n    iziToast.success({\n      message: `Hooray! We found ${totalHits} images.`,\n      position: 'topRight',\n    });\n    spinnerPlay();\n\n    const markup = createMarkupImg(hits);\n    updateMarkup(markup);\n\n    spinnerStop();\n  } catch (error) {\n    console.log(error);\n    clearGallery();\n    spinnerStop();\n  }\n}\n\nfunction updateMarkup(markup) {\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n  lightboxGallery.refresh();\n  smoothScroll();\n}\n\nfunction clearGallery() {\n  refs.gallery.innerHTML = '';\n}\n\nasync function onEntry(entries) {\n  spinnerPlay();\n\n  entries.forEach(async entry => {\n    try {\n      if (\n        entry.isIntersecting &&\n        pixabay.query !== '' &&\n        refs.gallery.childElementCount !== 0\n      ) {\n        pixabay.incrementPage();\n\n        const response = await pixabay.getImages();\n        const { hits } = response;\n\n        if (hits.length === 0) {\n          iziToast.info({\n            title: 'Info',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n          });\n\n          observer.unobserve(refs.infitity);\n          return;\n        }\n\n        const markup = createMarkupImg(hits);\n        updateMarkup(markup);\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      spinnerStop();\n    }\n  });\n}\n\nconst observer = new IntersectionObserver(onEntry, {\n  rootMargin: '100px',\n});\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","PixabayApiImages","searchParams","data","axios","total","createMarkupImg","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","spinnerPlay","spinnerStop","onSubmitForm","pixabay","lightboxGallery","SimpleLightbox","e","observer","clearGallery","iziToast","response","hits","totalHits","updateMarkup","error","smoothScroll","onEntry","entries","entry","cardHeight"],"mappings":"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"}